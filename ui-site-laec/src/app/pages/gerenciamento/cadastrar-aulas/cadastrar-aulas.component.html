<div class="cadastrar-aulas-page" [class.embedded]="isEmbedded">
  @if (!isEmbedded) {
    <div class="page-header">
      <div class="header-content">
        <button pButton class="p-button-text back-button" (click)="onCancel()">
          <i class="pi pi-arrow-left"></i>
        </button>
        <div class="title-section">
          <h1 class="page-title">
            <i class="pi pi-calendar-plus"></i>
            Cadastrar Aula Prática
          </h1>
          <p class="page-subtitle">Agende uma nova aula prática no laboratório</p>
        </div>
      </div>
    </div>
  }

  <div class="form-container">
    @if (errorMessage) {
      <p-message severity="error" [text]="errorMessage" />
    }

    @if (successMessage) {
      <p-message severity="success" [text]="successMessage" />
    }

    <form [formGroup]="aulaForm" (ngSubmit)="onSubmit()" class="aula-form">
      <!-- Informações Básicas -->
      <div class="form-section">
        <h3 class="section-title">Informações da Aula</h3>
        
        <div class="form-grid">
          <div class="form-field full-width">
            <label for="turmaId">Turma *</label>
            <p-select
              id="turmaId"
              formControlName="turmaId"
              [options]="turmasFiltradas"
              placeholder="Selecione a turma"
              optionLabel="label"
              optionValue="value"
              [class.p-invalid]="isFieldInvalid('turmaId')"
              styleClass="w-full"
            />
            @if (isFieldInvalid('turmaId')) {
              <small class="p-error">{{ getFieldError('turmaId') }}</small>
            }
          </div>

          <div class="form-field">
            <label for="dataAula">Data da Aula *</label>
            <p-datepicker
              id="dataAula"
              formControlName="dataAula"
              [showIcon]="true"
              [iconDisplay]="'input'"
              dateFormat="dd/mm/yy"
              placeholder="Selecione a data"
              [class.p-invalid]="isFieldInvalid('dataAula')"
              styleClass="w-full"
            />
            @if (isFieldInvalid('dataAula')) {
              <small class="p-error">{{ getFieldError('dataAula') }}</small>
            }
          </div>

          <div class="form-field">
            <label for="numeroAula">Número da Aula</label>
            <input 
              pInputText 
              id="numeroAula" 
              formControlName="numeroAula"
              type="number"
              placeholder="Ex: 1, 2, 3..."
              [class.p-invalid]="isFieldInvalid('numeroAula')"
            />
            @if (isFieldInvalid('numeroAula')) {
              <small class="p-error">{{ getFieldError('numeroAula') }}</small>
            }
          </div>
        </div>
      </div>

      <!-- Conteúdo da Aula -->
      <div class="form-section">
        <h3 class="section-title">Conteúdo</h3>
        
        <div class="form-grid">
          <div class="form-field full-width">
            <label for="tema">Tema *</label>
            <input 
              pInputText 
              id="tema" 
              formControlName="tema"
              placeholder="Ex: Anatomia Humana - Sistema Respiratório"
              [class.p-invalid]="isFieldInvalid('tema')"
            />
            @if (isFieldInvalid('tema')) {
              <small class="p-error">{{ getFieldError('tema') }}</small>
            }
          </div>

          <div class="form-field full-width">
            <label for="procedimento">Procedimento</label>
            <input 
              pInputText 
              id="procedimento" 
              formControlName="procedimento"
              placeholder="Ex: Dissecação de órgãos"
              [class.p-invalid]="isFieldInvalid('procedimento')"
            />
            @if (isFieldInvalid('procedimento')) {
              <small class="p-error">{{ getFieldError('procedimento') }}</small>
            }
          </div>

          <div class="form-field full-width">
            <label for="observacoes">Observações</label>
            <textarea 
              pTextarea
              id="observacoes" 
              formControlName="observacoes"
              rows="4"
              placeholder="Informações adicionais sobre a aula..."
              [class.p-invalid]="isFieldInvalid('observacoes')"
            ></textarea>
            @if (isFieldInvalid('observacoes')) {
              <small class="p-error">{{ getFieldError('observacoes') }}</small>
            }
          </div>
        </div>
      </div>

      <!-- Botões de Ação -->
      <div class="form-actions">
        <button 
          pButton 
          type="button" 
          label="Cancelar" 
          icon="pi pi-times"
          class="p-button-secondary"
          (click)="onCancel()"
          [disabled]="isLoading"
        ></button>
        <button 
          pButton 
          type="submit" 
          label="Cadastrar Aula"
          icon="pi pi-check"
          [loading]="isLoading"
          [disabled]="aulaForm.invalid"
        ></button>
      </div>
    </form>
  </div>
</div>

